<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#1e3a5f">
    <title>ASM - Ficha de Avalia√ß√£o</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --azul-marinho: #1e3a5f;
            --dourado: #c9a227;
            --cinza-claro: #f5f5f5;
            --branco: #ffffff;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, var(--azul-marinho) 0%, #2c4a6e 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            color: var(--branco);
            margin-bottom: 30px;
            padding: 20px;
        }
        
        .header h1 {
            font-size: 1.5rem;
            margin-bottom: 5px;
        }
        
        .header h2 {
            font-size: 1rem;
            color: var(--dourado);
            font-weight: normal;
        }
        
        .form-card {
            background: var(--branco);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 8px 30px rgba(0,0,0,0.3);
        }
        
        .form-title {
            color: var(--azul-marinho);
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 3px solid var(--dourado);
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .form-title::before {
            content: '';
            width: 4px;
            height: 20px;
            background: var(--dourado);
            border-radius: 2px;
        }
        
        .form-group {
            margin-bottom: 18px;
        }
        
        .form-label {
            display: block;
            font-weight: 600;
            color: var(--azul-marinho);
            margin-bottom: 6px;
            font-size: 0.85rem;
        }
        
        .form-input {
            width: 100%;
            padding: 10px 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 0.95rem;
            transition: all 0.3s;
            font-family: inherit;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--dourado);
            box-shadow: 0 0 0 3px rgba(201, 162, 39, 0.2);
        }
        
        /* DATA AJUSTADA - N√ÉO SAI DA CAIXA */
        input[type="date"].form-input,
        input[type="time"].form-input,
        input[type="number"].form-input {
            width: 100%;
            max-width: 100%;
            padding: 8px 10px;
            font-size: 0.9rem;
        }
        
        .prof-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .prof-row-3 {
            display: grid;
            grid-template-columns: 2fr 1fr 1fr;
            gap: 10px;
        }
        
        .textarea-group {
            margin-bottom: 15px;
        }
        
        .textarea-group label {
            display: block;
            font-size: 0.85rem;
            color: var(--azul-marinho);
            margin-bottom: 5px;
            font-weight: 600;
        }
        
        .textarea-group textarea {
            width: 100%;
            min-height: 80px;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 0.95rem;
            resize: vertical;
            font-family: inherit;
        }
        
        .textarea-group textarea:focus {
            outline: none;
            border-color: var(--dourado);
        }
        
        .escala-dor {
            background: var(--cinza-claro);
            padding: 20px;
            border-radius: 15px;
            margin-top: 10px;
            border-left: 4px solid var(--dourado);
        }
        
        .escala-dor h4 {
            color: var(--azul-marinho);
            margin-bottom: 15px;
            font-size: 0.9rem;
            text-align: center;
        }
        
        .escala-numeros {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            flex-wrap: wrap;
            gap: 5px;
        }
        
        .numero-dor {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            border: 2px solid #ddd;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
            font-size: 0.9rem;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
        }
        
        .numero-dor:active {
            transform: scale(0.95);
        }
        
        .numero-dor.selected {
            background: var(--azul-marinho);
            color: white;
            border-color: var(--azul-marinho);
            transform: scale(1.1);
        }
        
        .numero-dor.dor-leve.selected { background: #4caf50; border-color: #4caf50; }
        .numero-dor.dor-media.selected { background: #ff9800; border-color: #ff9800; }
        .numero-dor.dor-intensa.selected { background: #f44336; border-color: #f44336; }
        
        .escala-linha {
            height: 4px;
            background: linear-gradient(to right, #4caf50 0%, #ff9800 50%, #f44336 100%);
            border-radius: 2px;
            margin: 0 17px;
        }
        
        .escala-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            font-size: 0.75rem;
            color: #666;
        }
        
        .checkbox-group {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 8px;
            background: white;
            padding: 10px 15px;
            border-radius: 20px;
            border: 1px solid #dee2e6;
            cursor: pointer;
        }
        
        .checkbox-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            accent-color: var(--azul-marinho);
            cursor: pointer;
        }
        
        .checkbox-item label {
            cursor: pointer;
            font-size: 0.9rem;
            color: #444;
            margin: 0;
        }
        
        .estrela-dor-container {
            background: var(--cinza-claro);
            padding: 20px;
            border-radius: 15px;
            margin-top: 10px;
            border-left: 4px solid var(--dourado);
        }
        
        .estrela-dor-container h4 {
            color: var(--azul-marinho);
            margin-bottom: 15px;
            font-size: 0.9rem;
            text-align: center;
        }
        
        .regioes-dor {
            display: grid;
            gap: 15px;
        }
        
        .regiao-item {
            background: white;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid #e0e0e0;
        }
        
        .regiao-item h5 {
            color: var(--azul-marinho);
            margin-bottom: 15px;
            font-size: 1rem;
            text-align: center;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--dourado);
        }
        
        .movimentos-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .movimento-item {
            background: var(--cinza-claro);
            padding: 12px;
            border-radius: 10px;
        }
        
        .movimento-item h6 {
            color: #333;
            font-size: 0.85rem;
            margin-bottom: 8px;
            text-align: center;
        }
        
        .movimento-botoes {
            display: flex;
            gap: 5px;
        }
        
        .btn-dor {
            flex: 1;
            padding: 10px 5px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 8px;
            font-size: 0.75rem;
            cursor: pointer;
            transition: all 0.3s;
            text-align: center;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
        }
        
        .btn-dor:active {
            transform: scale(0.95);
        }
        
        .btn-dor.selected-com-dor {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }
        
        .btn-dor.selected-sem-dor {
            background: #4caf50;
            color: white;
            border-color: #4caf50;
        }
        
        .captores-grid {
            display: grid;
            gap: 12px;
        }
        
        .captor-item {
            background: white;
            padding: 15px;
            border-radius: 12px;
            border: 2px solid #e0e0e0;
        }
        
        .captor-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .captor-nome {
            font-weight: 600;
            color: var(--azul-marinho);
            font-size: 0.95rem;
        }
        
        .captor-botoes {
            display: flex;
            gap: 8px;
        }
        
        .btn-captor {
            padding: 8px 16px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 20px;
            font-size: 0.8rem;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 500;
            user-select: none;
            -webkit-user-select: none;
            touch-action: manipulation;
        }
        
        .btn-captor:active {
            transform: scale(0.95);
        }
        
        .btn-captor.selected-positivo {
            background: #4caf50;
            color: white;
            border-color: #4caf50;
        }
        
        .btn-captor.selected-negativo {
            background: #f44336;
            color: white;
            border-color: #f44336;
        }
        
        .captor-obs {
            width: 100%;
            padding: 10px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 0.9rem;
            margin-top: 8px;
        }
        
        .assinatura-section {
            background: var(--cinza-claro);
            padding: 20px;
            border-radius: 15px;
            margin-top: 15px;
            border-left: 4px solid var(--dourado);
        }
        
        .assinatura-section h4 {
            color: var(--azul-marinho);
            margin-bottom: 15px;
            font-size: 0.9rem;
        }
        
        .signature-area {
            background: white;
            border: 2px dashed var(--azul-marinho);
            border-radius: 10px;
            position: relative;
        }
        
        .signature-pad {
            width: 100%;
            height: 150px;
            border-radius: 10px;
            touch-action: none;
            display: block;
        }
        
        .signature-label {
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            color: #999;
            font-size: 0.85rem;
            pointer-events: none;
        }
        
        .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
            justify-content: center;
        }
        
        .btn {
            flex: 1;
            min-width: 100px;
            max-width: 150px;
            padding: 15px 20px;
            border: none;
            border-radius: 25px;
            font-size: 0.85rem;
            font-weight: 600;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s;
        }
        
        .btn:active {
            transform: scale(0.95);
        }
        
        .btn-primary {
            background: linear-gradient(135deg, var(--azul-marinho), #2c4a6e);
            color: white;
        }
        
        .btn-success {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }
        
        .btn-whatsapp {
            background: linear-gradient(135deg, #25D366, #128C7E);
            color: white;
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #dc3545, #c82333);
            color: white;
        }
        
        .btn-small {
            padding: 8px 15px;
            font-size: 0.75rem;
            flex: none;
        }
        
        .footer {
            text-align: center;
            color: rgba(255,255,255,0.7);
            font-size: 0.75rem;
            margin-top: 30px;
            padding: 20px;
        }
        
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: #333;
            color: white;
            padding: 15px 30px;
            border-radius: 30px;
            opacity: 0;
            transition: all 0.3s;
            z-index: 9999;
            font-size: 0.9rem;
        }
        
        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }
        
        @media (max-width: 600px) {
            .prof-row, .prof-row-3 {
                grid-template-columns: 1fr;
            }
            .movimentos-grid {
                grid-template-columns: 1fr;
            }
            .escala-numeros {
                justify-content: center;
            }
            .numero-dor {
                width: 30px;
                height: 30px;
                font-size: 0.8rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üè• ASM Gest√£o Cl√≠nica</h1>
            <h2>Ficha de Avalia√ß√£o Fisioterap√™utica</h2>
        </div>
        
        <div class="form-card">
            <div class="form-title">üë§ Dados do Profissional</div>
            <div class="prof-row">
                <div class="form-group">
                    <label class="form-label">Fisioterapeuta</label>
                    <input type="text" class="form-input" id="nomeFisio" placeholder="Nome completo">
                </div>
                <div class="form-group">
                    <label class="form-label">CREFITO</label>
                    <input type="text" class="form-input" id="crefito" placeholder="N¬∫ do CREFITO">
                </div>
            </div>
        </div>
        
        <div class="form-card">
            <div class="form-title">üë§ Dados do Paciente</div>
            <div class="prof-row-3">
                <div class="form-group">
                    <label class="form-label">Nome Completo</label>
                    <input type="text" class="form-input" id="nomePaciente" placeholder="Nome completo">
                </div>
                <div class="form-group">
                    <label class="form-label">Idade</label>
                    <input type="number" class="form-input" id="idade" placeholder="Anos">
                </div>
                <div class="form-group">
                    <label class="form-label">Data Avalia√ß√£o</label>
                    <input type="date" class="form-input" id="dataAvaliacao">
                </div>
            </div>
            <div class="form-group">
                <label class="form-label">Profiss√£o</label>
                <input type="text" class="form-input" id="profissao" placeholder="Profiss√£o do paciente">
            </div>
        </div>
        
        <div class="form-card">
            <div class="form-title">üìù Queixa Principal</div>
            <div class="textarea-group">
                <textarea id="queixaPrincipal" placeholder="Descreva a queixa principal do paciente..."></textarea>
            </div>
        </div>
        
        <div class="form-card">
            <div class="form-title">üìñ Evolu√ß√£o dos Sintomas</div>
            <div class="textarea-group">
                <label>Como come√ßou?</label>
                <textarea id="comoComecou" placeholder="Descreva como os sintomas iniciaram..."></textarea>
            </div>
            <div class="textarea-group">
                <label>Quando come√ßou?</label>
                <textarea id="quandoComecou" placeholder="Data/Per√≠odo de in√≠cio dos sintomas..."></textarea>
            </div>
        </div>
        
        <div class="form-card">
            <div class="form-title">üò£ Escala Num√©rica da Dor</div>
            <div class="escala-dor">
                <h4>Toque no n√∫mero correspondente √† dor (0 a 10)</h4>
                <div class="escala-numeros">
                    <button type="button" class="numero-dor dor-leve" data-valor="0" onclick="selecionarDor(this)">0</button>
                    <button type="button" class="numero-dor dor-leve" data-valor="1" onclick="selecionarDor(this)">1</button>
                    <button type="button" class="numero-dor dor-leve" data-valor="2" onclick="selecionarDor(this)">2</button>
                    <button type="button" class="numero-dor dor-leve" data-valor="3" onclick="selecionarDor(this)">3</button>
                    <button type="button" class="numero-dor dor-media" data-valor="4" onclick="selecionarDor(this)">4</button>
                    <button type="button" class="numero-dor dor-media" data-valor="5" onclick="selecionarDor(this)">5</button>
                    <button type="button" class="numero-dor dor-media" data-valor="6" onclick="selecionarDor(this)">6</button>
                    <button type="button" class="numero-dor dor-intensa" data-valor="7" onclick="selecionarDor(this)">7</button>
                    <button type="button" class="numero-dor dor-intensa" data-valor="8" onclick="selecionarDor(this)">8</button>
                    <button type="button" class="numero-dor dor-intensa" data-valor="9" onclick="selecionarDor(this)">9</button>
                    <button type="button" class="numero-dor dor-intensa" data-valor="10" onclick="selecionarDor(this)">10</button>
                </div>
                <div class="escala-linha"></div>
                <div class="escala-labels">
                    <span>Sem dor</span>
                    <span>Dor leve</span>
                    <span>Dor moderada</span>
                    <span>Dor intensa</span>
                </div>
            </div>
        </div>
        
        <div class="form-card">
            <div class="form-title">üìç Extens√£o da Dor</div>
            <div class="textarea-group">
                <textarea id="extensaoDor" placeholder="Descreva a extens√£o da dor..."></textarea>
            </div>
        </div>
        
        <div class="form-card">
            <div class="form-title">üíä Tratamentos Anteriores</div>
            <div class="textarea-group">
                <label>Medica√ß√£o</label>
                <textarea id="medicacao" placeholder="Medica√ß√µes em uso..."></textarea>
            </div>
            <div class="textarea-group">
                <label>Cirurgias</label>
                <textarea id="cirurgias" placeholder="Hist√≥rico de cirurgias..."></textarea>
            </div>
            <div class="textarea-group">
                <label>Traumas</label>
                <textarea id="traumas" placeholder="Hist√≥rico de traumas..."></textarea>
            </div>
        </div>
        
        <div class="form-card">
            <div class="form-title">üîç Caracter√≠sticas da Dor</div>
            <div class="textarea-group">
                <label>Frequ√™ncia da dor</label>
                <textarea id="frequenciaDor" placeholder="Constante, intermitente, etc..."></textarea>
            </div>
            <div class="textarea-group">
                <label>O que piora a dor?</label>
                <textarea id="pioraDor" placeholder="Fatores que agravam a dor..."></textarea>
            </div>
            <div class="textarea-group">
                <label>O que melhora a dor?</label>
                <textarea id="melhoraDor" placeholder="Fatores que aliviam a dor..."></textarea>
            </div>
        </div>
        
        <div class="form-card">
            <div class="form-title">üåô Quest√µes Viscerais</div>
            <div class="checkbox-group">
                <label class="checkbox-item">
                    <input type="checkbox" id="acordaDor">
                    <label for="acordaDor">Acorda com dor?</label>
                </label>
                <label class="checkbox-item">
                    <input type="checkbox" id="dormeDor">
                    <label for="dormeDor">Dorme com dor?</label>
                </label>
                <label class="checkbox-item">
                    <input type="checkbox" id="dormeBem">
                    <label for="dormeBem">Dorme bem?</label>
                </label>
            </div>
            <div class="textarea-group">
                <label>Posi√ß√£o de dormir</label>
                <textarea id="posicaoDormir" placeholder="Posi√ß√£o habitual de sono..."></textarea>
            </div>
        </div>
        
        <div class="form-card">
            <div class="form-title">üö´ Contra-indica√ß√£o / Exames</div>
            <div class="textarea-group">
                <textarea id="contraindicacao" placeholder="Contra-indica√ß√µes e exames de imagem..."></textarea>
            </div>
        </div>
        
        <div class="form-card">
            <div class="form-title">ü•ó Condi√ß√µes Gerais</div>
            <div class="textarea-group">
                <label>Alimenta√ß√£o</label>
                <textarea id="alimentacao" placeholder="H√°bitos alimentares..."></textarea>
            </div>
            <div class="textarea-group">
                <label>Atividade F√≠sica</label>
                <textarea id="atividadeFisica" placeholder="Pr√°tica de atividades f√≠sicas..."></textarea>
            </div>
            <div class="textarea-group">
                <label>Emocional</label>
                <textarea id="emocional" placeholder="Aspectos emocionais..."></textarea>
            </div>
        </div>
        
        <div class="form-card">
            <div class="form-title">üëÅÔ∏è Inspe√ß√£o</div>
            <div class="textarea-group">
                <label>Inspe√ß√£o Est√°tica</label>
                <textarea id="inspecaoEstatica" placeholder="Observa√ß√µes da inspe√ß√£o est√°tica..."></textarea>
            </div>
            <div class="textarea-group">
                <label>Inspe√ß√£o Din√¢mica</label>
                <textarea id="inspecaoDinamica" placeholder="Observa√ß√µes da inspe√ß√£o din√¢mica..."></textarea>
            </div>
        </div>
        
        <div class="form-card">
            <div class="form-title">‚≠ê Estrela da Dor</div>
            <div class="estrela-dor-container">
                <h4>Avalia√ß√£o dos Movimentos (Toque nos bot√µes)</h4>
                <div class="regioes-dor">
                    <div class="regiao-item">
                        <h5>Regi√£o Lombar</h5>
                        <div class="movimentos-grid">
                            <div class="movimento-item">
                                <h6>Flex√£o (F)</h6>
                                <div class="movimento-botoes">
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Com dor</button>
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Sem dor</button>
                                </div>
                            </div>
                            <div class="movimento-item">
                                <h6>Extens√£o (E)</h6>
                                <div class="movimento-botoes">
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Com dor</button>
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Sem dor</button>
                                </div>
                            </div>
                            <div class="movimento-item">
                                <h6>Incl. Esq (Se)</h6>
                                <div class="movimento-botoes">
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Com dor</button>
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Sem dor</button>
                                </div>
                            </div>
                            <div class="movimento-item">
                                <h6>Incl. Dir (Sd)</h6>
                                <div class="movimento-botoes">
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Com dor</button>
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Sem dor</button>
                                </div>
                            </div>
                            <div class="movimento-item">
                                <h6>Rota√ß√£o Esq (Re)</h6>
                                <div class="movimento-botoes">
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Com dor</button>
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Sem dor</button>
                                </div>
                            </div>
                            <div class="movimento-item">
                                <h6>Rota√ß√£o Dir (Rd)</h6>
                                <div class="movimento-botoes">
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Com dor</button>
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Sem dor</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="regiao-item">
                        <h5>Regi√£o Tor√°cica</h5>
                        <div class="movimentos-grid">
                            <div class="movimento-item">
                                <h6>Flex√£o (F)</h6>
                                <div class="movimento-botoes">
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Com dor</button>
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Sem dor</button>
                                </div>
                            </div>
                            <div class="movimento-item">
                                <h6>Extens√£o (E)</h6>
                                <div class="movimento-botoes">
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Com dor</button>
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Sem dor</button>
                                </div>
                            </div>
                            <div class="movimento-item">
                                <h6>Incl. Esq (Se)</h6>
                                <div class="movimento-botoes">
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Com dor</button>
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Sem dor</button>
                                </div>
                            </div>
                            <div class="movimento-item">
                                <h6>Incl. Dir (Sd)</h6>
                                <div class="movimento-botoes">
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Com dor</button>
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Sem dor</button>
                                </div>
                            </div>
                            <div class="movimento-item">
                                <h6>Rota√ß√£o Esq (Re)</h6>
                                <div class="movimento-botoes">
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Com dor</button>
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Sem dor</button>
                                </div>
                            </div>
                            <div class="movimento-item">
                                <h6>Rota√ß√£o Dir (Rd)</h6>
                                <div class="movimento-botoes">
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Com dor</button>
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Sem dor</button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="regiao-item">
                        <h5>Regi√£o Cervical</h5>
                        <div class="movimentos-grid">
                            <div class="movimento-item">
                                <h6>Flex√£o (F)</h6>
                                <div class="movimento-botoes">
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Com dor</button>
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Sem dor</button>
                                </div>
                            </div>
                            <div class="movimento-item">
                                <h6>Extens√£o (E)</h6>
                                <div class="movimento-botoes">
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Com dor</button>
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Sem dor</button>
                                </div>
                            </div>
                            <div class="movimento-item">
                                <h6>Incl. Esq (Se)</h6>
                                <div class="movimento-botoes">
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Com dor</button>
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Sem dor</button>
                                </div>
                            </div>
                            <div class="movimento-item">
                                <h6>Incl. Dir (Sd)</h6>
                                <div class="movimento-botoes">
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Com dor</button>
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Sem dor</button>
                                </div>
                            </div>
                            <div class="movimento-item">
                                <h6>Rota√ß√£o Esq (Re)</h6>
                                <div class="movimento-botoes">
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Com dor</button>
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Sem dor</button>
                                </div>
                            </div>
                            <div class="movimento-item">
                                <h6>Rota√ß√£o Dir (Rd)</h6>
                                <div class="movimento-botoes">
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Com dor</button>
                                    <button type="button" class="btn-dor" onclick="toggleDor(this)">Sem dor</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div class="form-card">
            <div class="form-title">üèÉ Diagn√≥stico por Exerc√≠cio</div>
            <div class="textarea-group">
                <textarea id="diagnosticoExercicio" placeholder="Resultados dos testes de exerc√≠cio repetitivo..."></textarea>
            </div>
        </div>
        
        <div class="form-card">
            <div class="form-title">üéØ Captores Posturais</div>
            <div class="captores-grid">
                <div class="captor-item">
                    <div class="captor-header">
                        <span class="captor-nome">Olho</span>
                        <div class="captor-botoes">
                            <button type="button" class="btn-captor" onclick="toggleCaptor(this, 'positivo')">Positivo</button>
                            <button type="button" class="btn-captor" onclick="toggleCaptor(this, 'negativo')">Negativo</button>
                        </div>
                    </div>
                    <input type="text" class="captor-obs" placeholder="Observa√ß√µes...">
                </div>
                
                <div class="captor-item">
                    <div class="captor-header">
                        <span class="captor-nome">ATM</span>
                        <div class="captor-botoes">
                            <button type="button" class="btn-captor" onclick="toggleCaptor(this, 'positivo')">Positivo</button>
                            <button type="button" class="btn-captor" onclick="toggleCaptor(this, 'negativo')">Negativo</button>
                        </div>
                    </div>
                    <input type="text" class="captor-obs" placeholder="Observa√ß√µes...">
                </div>
                
                <div class="captor-item">
                    <div class="captor-header">
                        <span class="captor-nome">P√©</span>
                        <div class="captor-botoes">
                            <button type="button" class="btn-captor" onclick="toggleCaptor(this, 'positivo')">Positivo</button>
                            <button type="button" class="btn-captor" onclick="toggleCaptor(this, 'negativo')">Negativo</button>
                        </div>
                    </div>
                    <input type="text" class="captor-obs" placeholder="Observa√ß√µes...">
                </div>
                
                <div class="captor-item">
                    <div class="captor-header">
                        <span class="captor-nome">Cicatrizes</span>
                        <div class="captor-botoes">
                            <button type="button" class="btn-captor" onclick="toggleCaptor(this, 'positivo')">Positivo</button>
                            <button type="button" class="btn-captor" onclick="toggleCaptor(this, 'negativo')">Negativo</button>
                        </div>
                    </div>
                    <input type="text" class="captor-obs" placeholder="Observa√ß√µes...">
                </div>
                
                <div class="captor-item">
                    <div class="captor-header">
                        <span class="captor-nome">V√≠sceras</span>
                        <div class="captor-botoes">
                            <button type="button" class="btn-captor" onclick="toggleCaptor(this, 'positivo')">Positivo</button>
                            <button type="button" class="btn-captor" onclick="toggleCaptor(this, 'negativo')">Negativo</button>
                        </div>
                    </div>
                    <input type="text" class="captor-obs" placeholder="Observa√ß√µes...">
                </div>
            </div>
        </div>
        
        <div class="form-card">
            <div class="form-title">üß† Testes Neurol√≥gicos</div>
            <div class="textarea-group">
                <textarea id="testesNeuro" placeholder="Descreva os testes realizados e seus resultados..."></textarea>
            </div>
        </div>
        
        <div class="form-card">
            <div class="form-title">üéØ Objetivos do Tratamento</div>
            <div class="textarea-group">
                <textarea id="objetivos" placeholder="Objetivos terap√™uticos estabelecidos..."></textarea>
            </div>
        </div>
        
        <div class="form-card">
            <div class="form-title">‚úçÔ∏è Assinatura Digital</div>
            <div class="assinatura-section">
                <h4>Assine com o dedo na tela abaixo:</h4>
                <div class="signature-area">
                    <canvas id="assinaturaCanvas" class="signature-pad"></canvas>
                    <span class="signature-label">Toque e arraste para assinar</span>
                </div>
                <div class="btn-group" style="margin-top: 10px;">
                    <button class="btn btn-danger btn-small" onclick="limparAssinatura()">üóëÔ∏è Limpar</button>
                </div>
            </div>
        </div>
        
        <div class="btn-group">
            <button class="btn btn-primary" onclick="salvarFicha()">
                üíæ Salvar
            </button>
            <button class="btn btn-success" onclick="gerarPDF()">
                üìÑ PDF
            </button>
            <button class="btn btn-whatsapp" onclick="enviarWhatsApp()">
                üí¨ WhatsApp
            </button>
        </div>
        
        <div class="footer">
            <p>ASM Gest√£o Cl√≠nica - Uso Licenciado</p>
            <p>¬© Dra. Andresa Augusto Nascimento</p>
            <p>Proibida reprodu√ß√£o ou compartilhamento sem autoriza√ß√£o</p>
        </div>
    </div>
    
    <div id="toast" class="toast"></div>

    <script>
        let nivelDorSelecionado = null;
        let assinaturaCanvas, assinaturaCtx;
        let isDrawing = false;
        let hasSignature = false;
        
        document.addEventListener('DOMContentLoaded', function() {
            initCanvas();
            document.getElementById('dataAvaliacao').valueAsDate = new Date();
            carregarDados();
        });
        
        function selecionarDor(elemento) {
            document.querySelectorAll('.numero-dor').forEach(function(el) {
                el.classList.remove('selected');
            });
            elemento.classList.add('selected');
            nivelDorSelecionado = elemento.getAttribute('data-valor');
        }
        
        function toggleDor(botao) {
            const container = botao.parentElement;
            const botoes = container.querySelectorAll('.btn-dor');
            botoes.forEach(function(btn) {
                btn.classList.remove('selected-com-dor', 'selected-sem-dor');
            });
            if (botao.textContent.includes('Com')) {
                botao.classList.add('selected-com-dor');
            } else {
                botao.classList.add('selected-sem-dor');
            }
        }
        
        function toggleCaptor(botao, tipo) {
            const container = botao.parentElement;
            const botoes = container.querySelectorAll('.btn-captor');
            botoes.forEach(function(btn) {
                btn.classList.remove('selected-positivo', 'selected-negativo');
            });
            if (tipo === 'positivo') {
                botao.classList.add('selected-positivo');
            } else {
                botao.classList.add('selected-negativo');
            }
        }
        
        function initCanvas() {
            assinaturaCanvas = document.getElementById('assinaturaCanvas');
            assinaturaCtx = assinaturaCanvas.getContext('2d');
            const container = assinaturaCanvas.parentElement;
            assinaturaCanvas.width = container.offsetWidth - 4;
            assinaturaCanvas.height = 150;
            assinaturaCtx.strokeStyle = '#1e3a5f';
            assinaturaCtx.lineWidth = 2;
            assinaturaCtx.lineCap = 'round';
            assinaturaCtx.lineJoin = 'round';
            
            assinaturaCanvas.addEventListener('mousedown', startDrawing);
            assinaturaCanvas.addEventListener('mousemove', draw);
            assinaturaCanvas.addEventListener('mouseup', stopDrawing);
            assinaturaCanvas.addEventListener('mouseout', stopDrawing);
            assinaturaCanvas.addEventListener('touchstart', handleTouch, {passive: false});
            assinaturaCanvas.addEventListener('touchmove', handleTouch, {passive: false});
            assinaturaCanvas.addEventListener('touchend', stopDrawing);
        }
        
        function startDrawing(e) {
            isDrawing = true;
            hasSignature = true;
            const rect = assinaturaCanvas.getBoundingClientRect();
            assinaturaCtx.beginPath();
            assinaturaCtx.moveTo(e.clientX - rect.left, e.clientY - rect.top);
            assinaturaCanvas.parentElement.querySelector('.signature-label').style.display = 'none';
        }
        
        function draw(e) {
            if (!isDrawing) return;
            const rect = assinaturaCanvas.getBoundingClientRect();
            assinaturaCtx.lineTo(e.clientX - rect.left, e.clientY - rect.top);
            assinaturaCtx.stroke();
        }
        
        function stopDrawing() {
            isDrawing = false;
        }
        
        function handleTouch(e) {
            e.preventDefault();
            const touch = e.touches[0];
            const rect = assinaturaCanvas.getBoundingClientRect();
            const x = touch.clientX - rect.left;
            const y = touch.clientY - rect.top;
            if (e.type === 'touchstart') {
                isDrawing = true;
                hasSignature = true;
                assinaturaCtx.beginPath();
                assinaturaCtx.moveTo(x, y);
                assinaturaCanvas.parentElement.querySelector('.signature-label').style.display = 'none';
            } else if (e.type === 'touchmove' && isDrawing) {
                assinaturaCtx.lineTo(x, y);
                assinaturaCtx.stroke();
            }
        }
        
        function limparAssinatura() {
            assinaturaCtx.clearRect(0, 0, assinaturaCanvas.width, assinaturaCanvas.height);
            hasSignature = false;
            assinaturaCanvas.parentElement.querySelector('.signature-label').style.display = 'block';
        }
        
        function salvarFicha() {
            const dados = coletarDados();
            const nome = document.getElementById('nomePaciente').value || 'Paciente';
            localStorage.setItem('fichaAvaliacao_' + nome + '_' + Date.now(), JSON.stringify(dados));
            
            // Salvar dados do fisioterapeuta
            const dadosFisio = {
                nomeFisio: document.getElementById('nomeFisio').value,
                crefito: document.getElementById('crefito').value
            };
            localStorage.setItem('asm_dados_fisio', JSON.stringify(dadosFisio));
            
            mostrarToast('‚úÖ Ficha salva com sucesso!');
        }
        
        function carregarDados() {
            // Carregar dados do fisioterapeuta
            const dadosFisio = JSON.parse(localStorage.getItem('asm_dados_fisio') || '{}');
            if (dadosFisio.nomeFisio) document.getElementById('nomeFisio').value = dadosFisio.nomeFisio;
            if (dadosFisio.crefito) document.getElementById('crefito').value = dadosFisio.crefito;
        }
        
        function coletarDados() {
            return {
                fisioterapeuta: {
                    nome: document.getElementById('nomeFisio').value,
                    crefito: document.getElementById('crefito').value
                },
                paciente: {
                    nome: document.getElementById('nomePaciente').value,
                    idade: document.getElementById('idade').value,
                    data: document.getElementById('dataAvaliacao').value,
                    profissao: document.getElementById('profissao').value
                },
                queixaPrincipal: document.getElementById('queixaPrincipal').value,
                comoComecou: document.getElementById('comoComecou').value,
                quandoComecou: document.getElementById('quandoComecou').value,
                nivelDor: nivelDorSelecionado,
                extensaoDor: document.getElementById('extensaoDor').value,
                medicacao: document.getElementById('medicacao').value,
                cirurgias: document.getElementById('cirurgias').value,
                traumas: document.getElementById('traumas').value,
                frequenciaDor: document.getElementById('frequenciaDor').value,
                pioraDor: document.getElementById('pioraDor').value,
                melhoraDor: document.getElementById('melhoraDor').value,
                acordaDor: document.getElementById('acordaDor').checked,
                dormeDor: document.getElementById('dormeDor').checked,
                dormeBem: document.getElementById('dormeBem').checked,
                posicaoDormir: document.getElementById('posicaoDormir').value,
                contraindicacao: document.getElementById('contraindicacao').value,
                alimentacao: document.getElementById('alimentacao').value,
                atividadeFisica: document.getElementById('atividadeFisica').value,
                emocional: document.getElementById('emocional').value,
                inspecaoEstatica: document.getElementById('inspecaoEstatica').value,
                inspecaoDinamica: document.getElementById('inspecaoDinamica').value,
                diagnosticoExercicio: document.getElementById('diagnosticoExercicio').value,
                testesNeuro: document.getElementById('testesNeuro').value,
                objetivos: document.getElementById('objetivos').value,
                assinatura: hasSignature ? assinaturaCanvas.toDataURL() : null,
                dataCriacao: new Date().toISOString()
            };
        }
        
        async function gerarPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            
            const nomePaciente = document.getElementById('nomePaciente').value || 'Paciente';
            const dataAvaliacao = document.getElementById('dataAvaliacao').value;
            
            // Cabe√ßalho
            doc.setFillColor(30, 58, 95);
            doc.rect(0, 0, 210, 35, 'F');
            
            doc.setTextColor(201, 162, 39);
            doc.setFontSize(18);
            doc.text('ASM Gest√£o Cl√≠nica', 105, 15, { align: 'center' });
            doc.setTextColor(255, 255, 255);
            doc.setFontSize(12);
            doc.text('Ficha de Avalia√ß√£o Fisioterap√™utica', 105, 25, { align: 'center' });
            
            let y = 45;
            
            // Profissional
            doc.setTextColor(30, 58, 95);
            doc.setFontSize(11);
            doc.setFont(undefined, 'bold');
            doc.text('PROFISSIONAL', 10, y);
            y += 7;
            doc.setFont(undefined, 'normal');
            doc.setFontSize(10);
            doc.text(`Nome: ${document.getElementById('nomeFisio').value || '_________________________________'}`, 10, y);
            y += 6;
            doc.text(`CREFITO: ${document.getElementById('crefito').value || '_________________________________'}`, 10, y);
            y += 10;
            
            // Paciente
            doc.setFont(undefined, 'bold');
            doc.setFontSize(11);
            doc.text('PACIENTE', 10, y);
            y += 7;
            doc.setFont(undefined, 'normal');
            doc.setFontSize(10);
            doc.text(`Nome: ${nomePaciente}`, 10, y);
            y += 6;
            doc.text(`Idade: ${document.getElementById('idade').value || '_____'} anos`, 10, y);
            y += 6;
            doc.text(`Data: ${dataAvaliacao ? new Date(dataAvaliacao).toLocaleDateString('pt-BR') : '___/___/_____'}`, 10, y);
            y += 6;
            doc.text(`Profiss√£o: ${document.getElementById('profissao').value || '_________________________________'}`, 10, y);
            y += 10;
            
            // Queixa principal
            const queixa = document.getElementById('queixaPrincipal').value;
            if (queixa) {
                if (y > 270) { doc.addPage(); y = 20; }
                doc.setFont(undefined, 'bold');
                doc.setFontSize(11);
                doc.text('QUEIXA PRINCIPAL', 10, y);
                y += 7;
                doc.setFont(undefined, 'normal');
                doc.setFontSize(10);
                const linhas = doc.splitTextToSize(queixa, 190);
                doc.text(linhas, 10, y);
                y += linhas.length * 5 + 5;
            }
            
            // Escala de dor
            if (nivelDorSelecionado !== null) {
                if (y > 270) { doc.addPage(); y = 20; }
                doc.setFont(undefined, 'bold');
                doc.setFontSize(11);
                doc.text('ESCALA DE DOR', 10, y);
                y += 7;
                doc.setFont(undefined, 'normal');
                doc.setFontSize(10);
                doc.text(`N√≠vel de dor: ${nivelDorSelecionado}/10`, 10, y);
                y += 10;
            }
            
            // Objetivos
            const objetivos = document.getElementById('objetivos').value;
            if (objetivos) {
                if (y > 270) { doc.addPage(); y = 20; }
                doc.setFont(undefined, 'bold');
                doc.setFontSize(11);
                doc.text('OBJETIVOS DO TRATAMENTO', 10, y);
                y += 7;
                doc.setFont(undefined, 'normal');
                doc.setFontSize(10);
                const linhas = doc.splitTextToSize(objetivos, 190);
                doc.text(linhas, 10, y);
                y += linhas.length * 5 + 5;
            }
            
            // Assinatura
            if (y > 250) { doc.addPage(); y = 20; }
            y += 10;
            doc.setFont(undefined, 'bold');
            doc.setFontSize(11);
            doc.text('ASSINATURA DO FISIOTERAPEUTA', 10, y);
            y += 10;
            
            if (hasSignature) {
                const imgData = assinaturaCanvas.toDataURL('image/png');
                doc.addImage(imgData, 'PNG', 10, y, 80, 30);
                y += 35;
            } else {
                doc.line(10, y, 90, y);
                y += 5;
            }
            
            // Rodap√©
            doc.setFontSize(8);
            doc.setTextColor(100, 100, 100);
            doc.text('ASM Gest√£o Cl√≠nica -- Uso Licenciado', 105, 285, { align: 'center' });
            doc.text('¬© ASM Gest√£o Cl√≠nica -- Dra. Andresa Augusto Nascimento | Uso licenciado ao comprador.', 105, 290, { align: 'center' });
            doc.text('Proibida reprodu√ß√£o ou compartilhamento sem autoriza√ß√£o.', 105, 295, { align: 'center' });
            
            doc.save(`Ficha_Avaliacao_${nomePaciente}.pdf`);
            mostrarToast('üìÑ PDF gerado com sucesso!');
        }
        
        function enviarWhatsApp() {
            const nomePaciente = document.getElementById('nomePaciente').value || 'Paciente';
            const data = document.getElementById('dataAvaliacao').value;
            const nomeFisio = document.getElementById('nomeFisio').value || 'Fisioterapeuta';
            
            let mensagem = `*Ficha de Avalia√ß√£o - ASM Gest√£o Cl√≠nica*%0A%0A`;
            mensagem += `Paciente: ${nomePaciente}%0A`;
            mensagem += `Data: ${data}%0A`;
            mensagem += `Fisioterapeuta: ${nomeFisio}%0A%0A`;
            mensagem += `Avalia√ß√£o realizada com sucesso!`;
            
            window.open(`https://wa.me/?text=${mensagem}`, '_blank');
        }
        
        function mostrarToast(mensagem) {
            const toast = document.getElementById('toast');
            toast.textContent = mensagem;
            toast.classList.add('show');
            setTimeout(() => toast.classList.remove('show'), 3000);
        }
        
        window.addEventListener('resize', function() {
            if (assinaturaCanvas) {
                const container = assinaturaCanvas.parentElement;
                assinaturaCanvas.width = container.offsetWidth - 4;
            }
        });
    </script>
</body>
</html>
